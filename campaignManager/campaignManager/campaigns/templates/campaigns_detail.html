{% extends 'campaigns_base.html' %}
{% load markdown_deux_tags %}

{% block title %}{{ campaign.name }}{% endblock %}

{% block main %}
<h1>
    {{ campaign.name }}
    {% if editable %}
        <a href="{% url 'campaigns:edit' campaign.pk %}" class="btn btn-default">Edit</a>
    {% endif %}
</h1>
<h3>by {{campaign.moderator}}</h3>      

<div class="row">
    <div class="col-xs-12">{{ campaign.game }}</div>
    <div class="col-xs-12">{{ campaign.get_status_value }}</div>
    <div class="col-xs-12">{{ campaign.blurb|markdown }}</div>
</div>

<table class="table table-striped table-hover">
    <caption>Participants</caption>
    <thead>
        <tr>
            <th>Name</th>
            <th class="hidden-xs">General</th>
        </tr>
    </thead>
    {% for campaign_army in campaign.campaignarmy_set.all %}
    <tr>
        <td>
            <a href="{% url 'armies:detail' campaign_army.army.pk %}">
                {{ campaign_army }}
                <span class="visible-xs">/ {{ campaign_army.army.user }}</span>
            </a>
        </td>
        <td class="hidden-xs">
            <a href="{% url 'profile:detail' campaign_army.army.user.username %}" >
                {{ campaign_army.army.user }}
            </a>
        </td>
    </tr>
    {% empty %}
    <tr><td>No armies are registered at this time</td></tr>
    {% endfor %}
    <tfoot>
        <tr>
        {% if editable %}
            <td>
                <a href="{% url 'invitations:send' campaign.pk %}" class='btn btn-primary'>
                    Extend an invitation to this campaign
                </a>
            </td>
        {% endif %}
        {% if is_participant and not has_army %}
        <td>
            <a href="{% url 'campaigns:new_army' campaign.pk %}" class="btn btn-primary">
                Create an army for this campaign
            </a>
        </td>
        {% endif %}
    </tr>
    </tfoot>
</table>

{% endblock %}
